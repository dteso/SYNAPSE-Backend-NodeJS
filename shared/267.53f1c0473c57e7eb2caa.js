(self.webpackChunklogin_app=self.webpackChunklogin_app||[]).push([[267],{8267:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ResourcesModule:()=>S});var o=i(8583),r=i(9866),n=i(5727),s=i(2340),l=i(8259),a=i.n(l),c=i(7716),d=i(5389),g=i(9744),h=i(6578),u=i(5146);let p=(()=>{class e{transform(e){let t=e.split("/");return t[t.length-1]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Yjl({name:"getFolderName",type:e,pure:!0}),e})(),f=(()=>{class e{transform(e,t=10){const i=e.replace(/(<([^>]+)>)/gi,"");return i.length>=t?`${i.slice(0,t)}...`:i}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.Yjl({name:"ellipsis",type:e,pure:!0}),e})();function m(e,t){1&e&&(c.TgZ(0,"div",11),c._UZ(1,"i",12),c.qZA())}function Z(e,t){if(1&e&&(c.TgZ(0,"h1",11),c._uU(1),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.hij(" ",e.currentPath,"")}}function b(e,t){1&e&&(c.TgZ(0,"div",13),c.TgZ(1,"h1",14),c._UZ(2,"i",15),c._uU(3," Server directories"),c.qZA(),c.TgZ(4,"p",14),c._uU(5,"No changes will be allowed in this directory tree. This is a tree view structure project for develpment usage."),c.qZA(),c.qZA())}function v(e,t){if(1&e&&(c.TgZ(0,"div"),c.TgZ(1,"label",26),c.TgZ(2,"strong"),c._uU(3,"Preview"),c.qZA(),c.qZA(),c.TgZ(4,"div",27),c._UZ(5,"img",28),c.qZA(),c.qZA()),2&e){const e=c.oxw(2);c.xp6(5),c.Q6J("src",e.imgTemp,c.LSH)}}function F(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",16),c.TgZ(1,"div",17),c.TgZ(2,"button",18),c.NdJ("click",function(){return c.CHM(e),c.oxw().onShowFileInput()}),c._UZ(3,"i",19),c.qZA(),c.qZA(),c.YNc(4,v,6,1,"div",20),c.TgZ(5,"div",21),c.TgZ(6,"input",22),c.NdJ("change",function(t){return c.CHM(e),c.oxw().loadFile(t)}),c.qZA(),c.qZA(),c.TgZ(7,"button",23),c.NdJ("click",function(){return c.CHM(e),c.oxw().uploadFile()}),c._UZ(8,"i",24),c.TgZ(9,"strong",25),c._uU(10),c.ALo(11,"translate"),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=c.oxw();c.xp6(4),c.Q6J("ngIf",e.imgTemp&&!e.isPdf),c.xp6(3),c.Q6J("disabled",!e.fileToUpload&&!e.isPdf),c.xp6(3),c.Oqu(c.lcZ(11,3,"BUTTON.ACTION.UPLOAD"))}}function w(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",29),c.TgZ(1,"div",30),c.NdJ("click",function(){return c.CHM(e),c.oxw().onBackFolder()}),c._UZ(2,"i",31),c.qZA(),c.TgZ(3,"div",32),c.TgZ(4,"div",33),c.NdJ("click",function(){return c.CHM(e),c.oxw().onShowFileInput()}),c._UZ(5,"i",34),c.qZA(),c.TgZ(6,"div",35),c.NdJ("click",function(){c.CHM(e);const t=c.oxw();return t.createFolder(t.currentPath)}),c._UZ(7,"i",36),c.qZA(),c.qZA(),c.qZA()}}function T(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",41),c.NdJ("click",function(){c.CHM(e);const t=c.oxw().$implicit;return c.oxw().getTreeNode(t.path)}),c._UZ(1,"i",42),c._uU(2),c.ALo(3,"getFolderName"),c.qZA()}if(2&e){const e=c.oxw().$implicit;c.xp6(2),c.Oqu(c.lcZ(3,1,e.path))}}function x(e,t){if(1&e&&(c.TgZ(0,"div",43),c._UZ(1,"i",44),c._uU(2),c.qZA()),2&e){const e=c.oxw().$implicit;c.xp6(2),c.Oqu(e.path)}}function A(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",45),c.NdJ("click",function(){c.CHM(e);const t=c.oxw().$implicit;return c.oxw().deleteFolder(t.path)}),c._UZ(1,"i",46),c.qZA()}}function U(e,t){if(1&e&&(c.TgZ(0,"div",37),c.YNc(1,T,4,3,"div",38),c.YNc(2,x,3,1,"div",39),c.YNc(3,A,2,0,"div",40),c.qZA()),2&e){const e=t.$implicit,i=c.oxw();c.xp6(1),c.Q6J("ngIf",!i.verifyIfIsFile(e.path)),c.xp6(1),c.Q6J("ngIf",i.verifyIfIsFile(e.path)&&!i.isImage(e.path)),c.xp6(1),c.Q6J("ngIf",!i.verifyIfIsFile(e.path)&&i.currentPath&&i.currentPath.length&&"."!==i.currentPath)}}function I(e,t){1&e&&(c.TgZ(0,"div",47),c.TgZ(1,"div",48),c.TgZ(2,"strong"),c._uU(3,"File"),c.qZA(),c.qZA(),c.TgZ(4,"div",49),c.TgZ(5,"p"),c._uU(6,"Catalog"),c.qZA(),c.qZA(),c.TgZ(7,"div",49),c._uU(8," Image "),c.qZA(),c.TgZ(9,"div",50),c._uU(10," Action "),c.qZA(),c.qZA())}function C(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",51),c.TgZ(1,"div",48),c.TgZ(2,"strong"),c._uU(3),c.ALo(4,"ellipsis"),c.qZA(),c.qZA(),c.TgZ(5,"div",49),c.TgZ(6,"p"),c._uU(7),c.qZA(),c.qZA(),c.TgZ(8,"div",52),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw().showImage(t.img.data)}),c.TgZ(9,"img",53),c.NdJ("load",function(){return c.CHM(e),c.oxw().setLoaded()}),c.qZA(),c.qZA(),c.TgZ(10,"div",50),c.TgZ(11,"i",54),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw().deleteFile(t.uid)}),c.qZA(),c.qZA(),c._UZ(12,"hr"),c.qZA()}if(2&e){const e=t.$implicit;c.xp6(3),c.Oqu(c.lcZ(4,3,e.name)),c.xp6(4),c.hij("/",e.catalog,""),c.xp6(2),c.Q6J("src","data:image/jpg;base64,"+e.img.data,c.LSH)}}const q=function(e){return{blured:e}},_="./shared",k=a().mixin({toast:!0,position:"top",background:"black",showConfirmButton:!1,timer:3e3,didOpen:e=>{e.addEventListener("mouseenter",a().stopTimer),e.addEventListener("mouseleave",a().resumeTimer)}}),L=[{path:"",component:(()=>{class e{constructor(e,t,i,o,r){this.fileUploadService=e,this.translateService=t,this.loaderService=i,this.storage=o,this.apiService=r,this.imagesLoadedCounter=0,this.imagesLoadedLength=0,this.isLoading=!0,this.showFileInput=!1,this.routes=[],this.previousFolder=_,this.currentPath=_,this.loaderService._loading$.next(!0)}ngOnInit(){this.fileUploadService.getFilesByFolder("shared").subscribe(e=>{console.log("Files",e),this.dbFiles=e.dbFiles,this.routes=e.routes.children,this.dbFiles.map(e=>e.src=this.getTruePath(e.src)),this.imagesLoadedLength=this.dbFiles.length,0===this.imagesLoadedLength&&this.loaderService._loading$.next(!1),this.isLoading=!1,console.log(this.dbFiles)})}loadFile(e){if(this.fileToUpload=e.target.files[0],console.log(this.fileToUpload),!this.fileToUpload)return;const t=new FileReader;t.readAsDataURL(this.fileToUpload),t.onloadend=()=>{console.log(t.result),this.imgTemp=t.result,"application/pdf"===this.fileToUpload.type&&(this.isPdf=!0)}}uploadFile(){a().fire({title:"Select catalog",input:"select",inputOptions:{catalog_1:"Catalog A",catalog_2:"Catalog B",catalog_3:"Catalog C",catalog_4:"Catalog D"},showCancelButton:!0,confirmButtonText:"Confirm Upload",cancelButtonText:"Close"}).then(e=>{if(e.value){let t=e.value;const i=this.currentPath.split("/")[this.currentPath.split("/").length-1];this.fileUploadService.subirArchivo(this.fileToUpload,t,this.currentPath).then(e=>{console.log("Imagen subida: "+e),this.imgTemp=void 0,this.fileToUpload=void 0,this.showPrompt(this.translateService.instant("FILE.UPLOAD.SUCCESS")),this.fileUploadService.getFilesByFolder(i).subscribe(e=>{this.dbFiles=e.dbFiles,this.dbFiles.map(e=>e.src=this.getTruePath(e.src)),this.imagesLoadedLength=this.dbFiles.length,this.showFileInput=!1})})}})}deleteFile(e){this.fileUploadService.deleteFile(e).subscribe(e=>{this.showPrompt(this.translateService.instant("FILE.DELETE.SUCCESS")),this.routes=e.routes.children,this.fileUploadService.getFilesByFolder(this.currentPath).subscribe(e=>{this.dbFiles=e.dbFiles,this.dbFiles.map(e=>e.src=this.getTruePath(e.src)),this.imagesLoadedLength=this.dbFiles.length})})}createFolder(e){console.log(e),a().fire({title:"File Name",input:"text",showCancelButton:!0,confirmButtonText:"Create",cancelButtonText:"Close"}).then(t=>{t.value&&this.fileUploadService.createFolder(`${e}/${t.value}`).subscribe(e=>{this.showPrompt(this.translateService.instant("FILE.FOLDER_CREATE.SUCCESS")),this.routes=e.routes.children})})}deleteFolder(e){this.fileUploadService.deleteFolder(`${e}`).subscribe(t=>{this.showPrompt(this.translateService.instant("FILE.FOLDER_DELETE.SUCCESS")),this.routes=t.routes.children,this.currentPath=this.getDirFromFileRoute(e)})}onBackFolder(){let e,t=this.currentPath.split("/");t.pop(),e=t.join("/"),this.getTreeNode(e)}getTreeNode(e){console.log("Getting tree node by root: ",e),this.currentPath=e,this.fileUploadService.getStructure(e).subscribe(t=>{t.paths&&(this.routes=t.paths.children),"."!==e&&this.fileUploadService.getFilesByFolder(e).subscribe(e=>{this.dbFiles=e.dbFiles,this.dbFiles.map(e=>e.src=this.getTruePath(e.src)),this.imagesLoadedLength=this.dbFiles.length,0===this.imagesLoadedLength&&this.loaderService._loading$.next(!1),this.isLoading=!1,console.log(this.dbFiles)})})}showPrompt(e){k.fire({icon:"success",title:e})}getTruePath(e){return`${s.N.base_url}/${(e=e.substring(_.length,e.length)).substring(1,e.length)}`}setLoaded(){this.imagesLoadedCounter++,this.imagesLoadedCounter===this.imagesLoadedLength&&(this.isLoading=!1,this.loaderService._loading$.next(!1))}verifyIfIsFile(e){return e.substring(1,e.length).indexOf(".")>0}onShowFileInput(){this.showFileInput=!this.showFileInput}getDirFromFileRoute(e){let t=e.split("/");return t.pop(),t.join("/")}isImage(e){let t=e.substring(_.length,e.length).split(".")[e.substring(_.length,e.length).split(".").length-1];return["jpg","jpeg","gif","png"].includes(t)}showImage(e){a().fire({imageUrl:"data:image/jpg;base64,"+e,imageWidth:400,imageAlt:"Custom image",showConfirmButton:!1})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(r.T),c.Y36(d.sK),c.Y36(g.D),c.Y36(h.V),c.Y36(u.s))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-resources"]],decls:15,vars:11,consts:[[1,"mb-3","mt-5","p-4",2,"text-align","center","background","rgb(29, 28, 28)","opacity","90%",3,"ngClass"],["style","color: white;",4,"ngIf"],[2,"padding","0.5rem","background","rgb(8, 10, 10)","border-radius","2%"],["style","color: white",4,"ngIf","ngIfElse"],["adviceBlock",""],["class","animated flipInX","style","padding: 1rem; border: solid 0.1rem rgb(42, 42, 42);border-radius: 2rem;",4,"ngIf"],["class","row flex-center mt-3","style","color: white; background-color: black; padding: 0.5rem;",4,"ngIf"],[2,"color","silver"],["class","row mt-1 animated flipInX",4,"ngFor","ngForOf"],["class","row mt-2","style","color: white; font-weight: bolder; background: black; opacity: 60%; padding-top: 0.5rem;",4,"ngIf"],["style","color: white;","class","row",4,"ngFor","ngForOf"],[2,"color","white"],[1,"fa","fa-file-pdf-o",2,"color","white","font-size","15rem"],[2,"background-color","rgb(250, 189, 189)","opacity","60%","padding","3rem","font-weight","bolder"],[2,"color","red"],[1,"fa","fa-exclamation-triangle"],[1,"animated","flipInX",2,"padding","1rem","border","solid 0.1rem rgb(42, 42, 42)","border-radius","2rem"],[1,"w-100",2,"text-align","right"],[1,"btn","btn-danger","mt-3",3,"click"],[1,"fa","fa-close"],[4,"ngIf"],[1,"mb-3","mt-3"],["type","file","accept","image/*","id","formFile",1,"form-control",3,"change"],[1,"btn","btn-info","mt-3",3,"disabled","click"],[1,"fa","fa-upload"],[2,"color","white","padding-left","1rem"],[1,"form-label",2,"color","white"],[1,"w-100",2,"height","auto"],[2,"border","1px solid white","max-width","100%","max-height","100%",3,"src"],[1,"row","flex-center","mt-3",2,"color","white","background-color","black","padding","0.5rem"],["title","Back",1,"col",2,"text-align","left","cursor","pointer",3,"click"],[1,"fa","fa-arrow-left",2,"font-size","1.5rem"],[1,"col","contents-right"],["title","Upload File",2,"cursor","pointer","margin-left","2rem",3,"click"],[1,"fa","fa-upload",2,"font-size","1.5rem"],["title","Create Folder",2,"cursor","pointer","margin-left","2rem",3,"click"],[1,"fa","fa-folder",2,"font-size","1.5rem"],[1,"row","mt-1","animated","flipInX"],["class","col folder",3,"click",4,"ngIf"],["style","color: white; text-align: left; font-size: larger; opacity: 70%; padding: 1rem; cursor: pointer; border-radius: 1%",4,"ngIf"],["class","col-1 mt-3","style","color: rgb(231, 132, 3); cursor: pointer; font-size: 1.5rem;",3,"click",4,"ngIf"],[1,"col","folder",3,"click"],[1,"fa","fa-folder","p-2"],[2,"color","white","text-align","left","font-size","larger","opacity","70%","padding","1rem","cursor","pointer","border-radius","1%"],[1,"fa","fa-file","p-2"],[1,"col-1","mt-3",2,"color","rgb(231, 132, 3)","cursor","pointer","font-size","1.5rem",3,"click"],[1,"fa","fa-trash"],[1,"row","mt-2",2,"color","white","font-weight","bolder","background","black","opacity","60%","padding-top","0.5rem"],[1,"col-4",2,"text-align","left"],[1,"col-3"],[1,"col-2"],[1,"row",2,"color","white"],[1,"col-3",2,"cursor","pointer",3,"click"],["width","35rem","height","35rem",3,"src","load"],[1,"fa","fa-trash",2,"cursor","pointer",3,"click"]],template:function(e,t){if(1&e&&(c.TgZ(0,"div",0),c.YNc(1,m,2,0,"div",1),c.TgZ(2,"div",2),c.YNc(3,Z,2,1,"h1",3),c.qZA(),c.YNc(4,b,6,0,"ng-template",null,4,c.W1O),c._UZ(6,"hr"),c.TgZ(7,"div"),c.YNc(8,F,12,5,"div",5),c.YNc(9,w,8,0,"div",6),c._UZ(10,"hr",7),c.YNc(11,U,4,3,"div",8),c.qZA(),c.YNc(12,I,11,0,"div",9),c._UZ(13,"hr"),c.YNc(14,C,13,5,"div",10),c.qZA()),2&e){const e=c.MAs(5);c.Q6J("ngClass",c.VKq(9,q,t.isLoading)),c.xp6(1),c.Q6J("ngIf",t.isPdf),c.xp6(2),c.Q6J("ngIf",t.currentPath&&t.currentPath.length&&"."!==t.currentPath)("ngIfElse",e),c.xp6(5),c.Q6J("ngIf",t.currentPath&&t.currentPath.length&&"."!==t.currentPath&&t.showFileInput),c.xp6(1),c.Q6J("ngIf",t.currentPath&&t.currentPath.length&&"."!==t.currentPath),c.xp6(2),c.Q6J("ngForOf",t.routes),c.xp6(1),c.Q6J("ngIf",t.dbFiles&&t.dbFiles.length),c.xp6(2),c.Q6J("ngForOf",t.dbFiles)}},directives:[o.mk,o.O5,o.sg],pipes:[d.X$,p,f],styles:[".folder[_ngcontent-%COMP%]{color:#fff;text-align:left;font-size:larger;background-color:#098ff0;opacity:70%;padding:1rem;cursor:pointer;border-radius:1%}.folder[_ngcontent-%COMP%]:hover{background-color:#034a7c}i[_ngcontent-%COMP%]:hover{font-size:1.6rem!important}.file[_ngcontent-%COMP%]{color:#fff;text-align:left;font-size:larger;background-color:#0b6eaf;opacity:70%;padding:1rem;cursor:pointer;border-radius:3%}.contents-right[_ngcontent-%COMP%]{text-align:right;display:contents}"]}),e})()}];let P=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[n.Bz.forChild(L)],n.Bz]}),e})(),S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({providers:[r.T,d.sK],imports:[[o.ez,P,d.aw]]}),e})()}}]);